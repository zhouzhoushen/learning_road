# 关于代码风格的笔记

## 想要记录的原因

在暑期学校中我和同学组队完成了一个虚拟校园的 Java 项目，使用 CS 架构通信，我负责前端界面的设计及代码编写，以及前端通信的代码编写。

我发现在写代码时我的头脑是模糊而混乱的，因此我的代码**像屎山一样冗余累赘**。要求 200 行以内完成页面布局以及通信部分，我因为生疏以及懒惰直接 cv 而不封装，导致我的每一个界面代码最终都有**一千余行**，难以阅读，也不清晰。

因此，我在课程结束后总结下这次有些惨痛的经历，在下次编写代码需要能记得一些技巧。

## 如何精简文件中的 Java 代码?

**函数封装**
有些几十余行的工具类代码，我一个文件里复制一份，导致**代码重复量极大**。这个时候，应该**建立 `utils` 包**，把这些多处复用的功能封装成工具函数并放在**公共类**里以便随处都可调用。  

**分层设计**
现在我已经了解了单纯的 JavaSwing 前端开发需要做哪些工作，通过功能逻辑分层的方式，我可以进一步精简每个文件中的代码，下层的功能上层只需调用相关方法即可。  

具体到我的工作部分，**页面设计和通信逻辑可以分为两层**，分别在相邻两个包内实现。页面设计层的内容是纯粹地使用 Swing 布局界面，以及处理界面跳转的逻辑。通信层则封装了一些通信函数，它们被页面设计层调用，接收页面传来的参数，比如VO实例以及相关的属性值，然后在方法实现内进行序列化/反序列化与 `Message` 的装拆箱，同时把界面需要展示的数据作为返回值。  

分层设计实际上是我们整个项目使用的架构，在代码编写时**逐层设计逐层测试**，上层只调用下层封装好的方法，层间无依赖或者说耦合度低，因此在需要改动时只需改动某层代码即可。

对于一些**一次性**的对象创建，例如对某个控件增加监听器时对监听器接口的实现因为与控件功能挂钩因此是**一次性**的，此时可以通过 **Lambda** **函数**的方式简化代码同时增加可读性。

## 其他需要注意的 Java 代码编写规范

**1\.** Java 是纯粹地面向对象的，因此类无处不在。**类成员权限与属性的声明**完全由该成员的应用方式决定。例如，类引用成员若指向的地址不会再变了就应该声明为 final，没必要每个实例一个或者必须要共享的声明为 static，权限的话为了高内聚尽量设为 private。这些**在你写下声明的时候就应该确定了**，不要想着等后面发现因为属性设置限制了使用才回来改，这样非常低效，因为这个时候可能成员变量已经在多处被依赖，而且这种思路下往往不止一个变量的权限需要修改，后期的修改也不是为了优化程序，只是为先前的无脑进行弥补罢了。

**2\.** 注释很重要。注释的风格可以随心所欲，但这是不负责的行为，因为有队友和后来者也会参与开发。所以**文档注释，类注释，方法注释，其他单行或多行注释需要一致的风格**以及确定必须以注释的方式提供的信息，不要什么都注释。注释应该逐方法，类，文件进行编写与维护。

**3\.** 代码风格，参见 Google 代码规范或老师提供的 Java 编码规范文档。这使代码可读性高，而且有风格严谨一致的优美感。

**4\.** 写代码时**首先实现功能**，**然后**根据上述规则**进行重构与注释**，逐方法逐类进行，不要舍本逐末。

**5\.** **不用先看完教程再开始编程**。应该先了解，基础知识差不多了就开始做，然后根据实际的需求再去搜索提问需要的功能。先看完教程，开始做的时候 90% 都忘得差不多了，更别说花力气去实践。

## 本项目中使用的一些重要的工具

Git，Github，Maven，IDEA，Java，Java Swing，Socket，Sqlite。

## 写在最后

我看过许多资料，都忘了。实践的时候什么也想不起来，像个原始人一样，所以 **重在应用，重在应用，重在应用!**

关于团队，在存在竞争的情况下，应该**占据团队决策层，占据工作掌控权**。否则功劳不由你说了算。
